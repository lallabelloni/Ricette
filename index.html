<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Test Supabase</title>
</head>
<body>

  <h1>Test connessione Supabase</h1>

  <div id="output">Caricamento...</div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    /* ==========================
       CONFIG SUPABASE
    ========================== */
    const supabaseUrl = 'https://uummgynzxypcscvqtihf.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV1bW1neW56eHlwY3NjdnF0aWhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMjE2ODAsImV4cCI6MjA4MjY5NzY4MH0.e0mQ1QZ2B86JsAuy24kIkt43-m6KQz_zj7oYIi8P6I8'
    const supabase = createClient(supabaseUrl, supabaseKey)

    /* ==========================
       TEST QUERY
    ========================== */
    async function testDB() {
      const { data, error } = await supabase
        .from('ricetta')
        .select('*')
        .limit(1)

      const output = document.getElementById('output')

      if (error) {
        console.error(error)
        output.innerHTML = `<p style="color:red">Errore: ${error.message}</p>`
        return
      }

      if (!data || data.length === 0) {
        output.innerHTML = '<p>Nessuna ricetta trovata nel DB</p>'
        return
      }

      const ricetta = data[0]

      output.innerHTML = `
        <h2>${ricetta.titolo}</h2>
        <p>${ricetta.descrizione ?? ''}</p>
        <pre>${JSON.stringify(ricetta, null, 2)}</pre>
      `
    }

    testDB()
  </script>

</body>
</html>
