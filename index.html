<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Ricerca ricetta</title>
</head>
<body>

  <h1>Ricerca ricetta üç∞</h1>

  <input
    type="text"
    id="searchInput"
    placeholder="Scrivi il nome della ricetta..."
  >
  <button id="searchBtn">Cerca</button>

  <div id="output"></div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    /* ==========================
       CONFIG SUPABASE
    ========================== */
    const supabaseUrl = 'https://uummgynzxypcscvqtihf.supabase.co'
    const supabaseKey = 'INCOLLA QUI LA ANON KEY'
    const supabase = createClient(supabaseUrl, supabaseKey)

    /* ==========================
       RICERCA PER NOME
    ========================== */
    async function searchRicette() {
      const query = document
        .getElementById('searchInput')
        .value
        .trim()

      const output = document.getElementById('output')
      output.innerHTML = ''

      if (query.length === 0) {
        output.innerHTML = '<p>Inserisci un testo per cercare</p>'
        return
      }

      const { data, error } = await supabase
        .from('ricetta')
        .select('id, nome')
        .ilike('nome', `%${query}%`)

      if (error) {
        console.error(error)
        output.innerHTML = `<p style="color:red">Errore: ${error.message}</p>`
        return
      }

      if (!data || data.length === 0) {
        output.innerHTML = '<p>Nessuna ricetta trovata</p>'
        return
      }

      data.forEach(ricetta => {
        const div = document.createElement('div')
        div.innerHTML = `<h3>${ricetta.nome}</h3>`
        output.appendChild(div)
      })
    }

    document
      .getElementById('searchBtn')
      .addEventListener('click', searchRicette)
  </script>

</body>
</html>
